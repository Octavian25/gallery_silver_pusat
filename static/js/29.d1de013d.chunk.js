(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{1255:function(a,e,t){"use strict";t.r(e);var n=t(8),r=t(9),l=t(15),o=t(11),i=t(10),s=t(0),c=t(18),m=t(67),u=t.n(m),b=function(a){Object(o.a)(t,a);var e=Object(i.a)(t);function t(a){var r;return Object(n.a)(this,t),(r=e.call(this,a)).state={date:new Date},r.setStartDate=r.setStartDate.bind(Object(l.a)(r)),r.setLastDate=r.setLastDate.bind(Object(l.a)(r)),r}return Object(r.a)(t,[{key:"handleSubmit",value:function(a){}},{key:"setStartDate",value:function(a){this.setState({tgl_awal:new Date(a)})}},{key:"setLastDate",value:function(a){this.setState({tgl_akhir:new Date(a)})}},{key:"render",value:function(){var a=this;return s.o.createElement("div",null,s.o.createElement("form",{onSubmit:this.props.handleSubmit,onKeyPress:function(a){"Enter"===a.key&&a.preventDefault()},autoComplete:"off"},s.o.createElement("div",{className:"row"},s.o.createElement("div",{className:"col-lg-4"},s.o.createElement(s.d,{name:"tgl_awal",component:s.g,label:"Tanggal Dari",type:"text",selected:this.state.tgl_awal,onChange:function(e){return a.setStartDate(e)},placeholder:"Masukan Tanggal Dari"})),s.o.createElement("div",{className:"col-lg-4"},s.o.createElement(s.d,{name:"tgl_akhir",component:s.g,type:"text",selected:this.state.tgl_akhir,onChange:function(e){return a.setLastDate(e)},label:"Tanggal Akhir",placeholder:"Masukan Tanggal Akhir"})),s.o.createElement("div",{className:"col-lg-4"},s.o.createElement("div",{className:"text-right"},s.o.createElement("label",null,"\xa0"),s.o.createElement("button",{type:"submit",value:"PDF",name:"type_btn",className:"btn btn-primary btn-block"},this.props.isLoading?s.o.createElement(s.o.Fragment,null,s.o.createElement("i",{className:"fas fa-spinner fa-spin"})," \xa0 Sedang Mencari"):"Cari Pesanan")))),this.props.isLoading?s.o.createElement(u.a,{loading:!0,background:"rgba(0, 0, 0, 0.35)",loaderColor:"rgba(94, 147, 117, 1)"}):null))}}]),t}(s.o.Component);b=Object(s.Y)({form:"HeadPesanan",enableReinitialize:!0})(b);var p=Object(s.w)(function(a){return{initialValues:{tgl_awal:Object(s.I)(),tgl_akhir:Object(s.I)()}}})(b),d=t(693),h=t(7),g=Object(s.y)({prefix:"Rp. ",locale:"kr-KO"}),_=[{value:"CASH",name:"CASH"},{value:"DEBET",name:"DEBET"},{value:"TRANSFER",name:"TRANSFER"},{value:"CREDIT",name:"CREDIT"}],f=function(a){Object(o.a)(t,a);var e=Object(i.a)(t);function t(a){var r;return Object(n.a)(this,t),(r=e.call(this,a)).state={isLoading:!1,type_pembayaran:"CASH",columns:[{dataField:"type",text:"Type",footerAttrs:{colSpan:"1"},footer:"Grand Total"},{dataField:"Total",text:"Total",footer:""}]},r}return Object(r.a)(t,[{key:"componentDidMount",value:function(){var a=this;this.props.dispatch(Object(h.Db)());var e=JSON.parse(Object(s.P)("data_barang_ambil_pesanan"));setTimeout(function(){var e=JSON.parse(localStorage.getItem("trx_pemabayran_ambil_pesanan"))||[],t=0;e.forEach(function(a){t=a.nominal+t});var n=Object(s.k)(document.getElementById("grand_total_pembayaran").value);a.props.change("harus_bayar_rp",parseInt(n)-parseInt(t))},100),this.props.change("grand_total_pembayaran",e.total_harga),this.props.change("jenis","CASH"),setTimeout(function(){document.getElementById("cash_trx_penjualan").focus()},100)}},{key:"hitungTotal",value:function(){this.props.change("kembali",this.props.kembali),this.props.change("nominal_kembali",this.props.nominal_kembali)}},{key:"pilihPembyaran",value:function(a){"CASH"===a?this.setState({type_pembayaran:"CASH"}):"TRANSFER"===a?this.setState({type_pembayaran:"TRANSFER"}):"DEBET"===a?this.setState({type_pembayaran:"DEBET"}):this.setState({type_pembayaran:"CREDIT"}),this.props.change("cash","")}},{key:"render",value:function(){var a=this;return s.o.createElement("form",{onSubmit:this.props.handleSubmit,onKeyPress:function(a){"Enter"===a.key&&a.preventDefault()},autoComplete:"off"},s.o.createElement("div",{className:"row"},s.o.createElement("div",{className:"col-6"},s.o.createElement(s.d,Object.assign({id:"grand_total_pembayaran",name:"grand_total_pembayaran",component:s.q,type:"text",onChange:this.hitungTotal(),readOnly:!0},g,{label:"Total Harga Jual",placeholder:"Total Harga Jual"}))),s.o.createElement("div",{className:"col-6"},s.o.createElement(s.d,Object.assign({id:"harus_bayar_rp",name:"harus_bayar_rp",component:s.q,type:"text",onChange:this.hitungTotal(),readOnly:!0},g,{label:"Harus Bayar Rp",placeholder:"Harus Bayar Rp"}))),s.o.createElement("div",{className:"col-6"},s.o.createElement(s.d,{name:"jenis",label:"Pilih Jenis Bayar",placeholder:"Pilih Jenis Pembayaran",options:_,onChange:function(e){return a.pilihPembyaran(e)},component:s.r})),s.o.createElement("div",{className:"col-6",style:{display:"CASH"===this.state.type_pembayaran?"none":(this.state.type_pembayaran,"block")}},s.o.createElement(s.d,{tabIndex:"1",name:"nama_bank",id:"nama_bank",component:s.q,type:"text",label:"Bank",placeholder:"Masukan Nama Bank"})),s.o.createElement("div",{className:"col-6",style:{display:"CASH"===this.state.type_pembayaran?"none":"DEBET"===this.state.type_pembayaran?"none":"block"}},s.o.createElement(s.d,{tabIndex:"1",name:"no_card",id:"no_card",component:s.q,type:"text",label:"Card No",placeholder:"Masukan Card No"})),s.o.createElement("div",{className:"col-6"},s.o.createElement(s.d,Object.assign({tabIndex:"1",name:"cash",id:"cash_trx_penjualan",component:s.q,type:"text",label:"Nominal",onChange:this.hitungTotal()},g,{normalize:s.k,placeholder:"Masukan Nominal"}))),s.o.createElement("div",{className:"col-6",style:{display:"CREDIT"===this.state.type_pembayaran?"block":"none"}},s.o.createElement(s.d,{tabIndex:"1",name:"fee",id:"fee",component:s.q,type:"text",label:"Fee (%)",normalize:s.k,placeholder:"5"})),s.o.createElement("div",{className:"col-6 d-none"},s.o.createElement(s.d,{tabIndex:"1",name:"nominal_kembali",component:s.q,type:"text",label:"Nominal",placeholder:"Masukan Nominal"})),s.o.createElement("div",{className:"col-6"},s.o.createElement(s.d,{name:"kembali",id:"sisa_bayar",component:s.q,type:"text",readOnly:!0,label:"Sisa",normalize:s.k,placeholder:"Sisa Pembayaran"})),s.o.createElement("div",{className:"CASH"===this.state.type_pembayaran?"col-6 text-right":"TRANSFER"===this.state.type_pembayaran?"col-6 text-right":"col-12 text-right"},s.o.createElement("br",null),s.o.createElement("label",null,"\xa0"),s.o.createElement("button",{tabIndex:"2",className:"btn btn-primary"}," ",s.o.createElement("i",{className:"fa fa-plus"})))))}}]),t}(s.b);f=Object(s.Y)({form:"HeadInputPembayaran",enableReinitialize:!0,validate:d.a})(f);var y=Object(s.A)("HeadInputPembayaran"),E=Object(s.w)(function(a){var e=y(a,"grand_total_pembayaran","cash"),t=e.cash,n=e.grand_total_pembayaran,r=JSON.parse(localStorage.getItem("trx_pemabayran_ambil_pesanan"))||[],l=0;r.forEach(function(a){l=a.nominal+l});var o=parseFloat(l||0)-parseFloat(n||0);return{harus_bayar_rp:o,kembali:o.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),nominal_cash:t,nominal_kembali:o+parseInt(t)}})(f),k=function(a){Object(o.a)(t,a);var e=Object(i.a)(t);function t(a){var r;return Object(n.a)(this,t),(r=e.call(this,a)).state={isLoading:!1,type_pembayaran:"CASH",kembalian:"",columns:[{dataField:"jenis",text:"Jenis",footerAttrs:{colSpan:"2"},footer:"Grand Total"},{dataField:"keterangan",text:"Keterangan"},{dataField:"nominal",text:"Total",formatter:function(a){return s.o.createElement("span",null,parseInt(a).toLocaleString("kr-KO"))},footer:function(a){return parseInt(a.reduce(function(a,e){return a+e},0)).toLocaleString("kr-KO")}},{dataField:"action",text:"Action",csvExport:!1,headerClasses:"text-center",formatter:function(a,e,t){return s.o.createElement("div",{className:"row text-center"},s.o.createElement("div",{className:"col-12"},s.o.createElement("button",{type:"button",disabled:"DONE"===e.status,onClick:function(){return r.hapusdata(t)},className:"btn btn-danger mr-3"},s.o.createElement("i",{className:"fa fa-trash"}))))},footer:""}]},r}return Object(r.a)(t,[{key:"hapusdata",value:function(a){var e=this;s.t.fire({title:"Anda Yakin !!",text:"Ingin Menghapus Data Ini ?",icon:"warning",position:"top-center",cancelButtonText:"Tidak",showCancelButton:!0,confirmButtonText:"OK",showConfirmButton:!0}).then(function(t){if(t.isConfirmed){var n=Object(s.H)("trx_pemabayran_ambil_pesanan");n.splice(a,1),Object(s.ab)("trx_pemabayran_ambil_pesanan",n),e.setState({status:"berhasil"})}})}},{key:"simpanPembayaran",value:function(a){if(void 0===a.no_card&&"CASH"!==a.jenis&&"DEBET"!==a.jenis)return Object(s.v)("info","Nomor kartu tidak boleh kosong"),!1;var e={total_transaksi:a.grand_total_pembayaran,sisa_bayar:a.nominal_kembali};if(void 0===a.nama_bank&&"CASH"!==a.jenis)return Object(s.v)("info","Nama Bank tidak boleh kosong"),!1;if(void 0===a.cash||"0"===a.cash)return Object(s.v)("info","Nominal tidak boleh kosong"),!1;Object(s.ab)("sisa_bayar_pesanan",e);var t=JSON.parse(localStorage.getItem("trx_pemabayran_ambil_pesanan"))||[];if("CASH"===a.jenis||t.length){if("CASH"!==a.jenis){if(a.kembali.replace(/[^0-9]/g,"")-a.cash<0&&0!==parseInt(a.kembali))return Object(s.v)("info","Pembayaran tidak boleh lebih dari sisa"),!1;if(console.log(a.grand_total_pembayaran),t.reduce(function(a,e){return a+e.nominal},0)>=a.grand_total_pembayaran)return Object(s.v)("info","Pembayaran Sudah Cukup1"),!1}}else if(a.kembali.replace(/[^0-9]/g,"")-a.cash<0)return Object(s.v)("info","Pembayaran tidak boleh lebih dari sisa"),!1;if(t.findIndex(function(a){return"CASH"===a.jenis})>=0){if(a.kembali.replace(/[^0-9]/g,"")-a.cash<0&&t.reduce(function(a,e){return a+e.nominal},0)>a.grand_total_pembayaran)return Object(s.v)("info","Pembayaran Sudah Cukup2"),!1;if(t.reduce(function(a,e){return a+e.nominal},0)>=a.grand_total_pembayaran)return Object(s.v)("info","Pembayaran Sudah Cukup3"),!1}if(-1===t.findIndex(function(e){return e.jenis===a.jenis})){var n="";n="CASH"===a.jenis?"CASH":"TRANSFER"===a.jenis?a.no_card+" - "+a.nama_bank:a.nama_bank;var r={jenis:a.jenis,nominal:parseInt(a.cash)*parseInt(a.fee||0)/100+parseInt(a.cash),nama_bank:a.nama_bank,fee:"CREDIT"===a.jenis&&a.fee||0,no_card:a.no_card||"-",keterangan:n,kembali:a.nominal_kembali};t.push(r),this.setState({masuk:!0,kembalian:a.kembali}),Object(s.ab)("trx_pemabayran_ambil_pesanan",t)}else{var l=Object(s.H)("trx_pemabayran_ambil_pesanan");l=l.map(function(e){return e.jenis===a.jenis&&(e.nominal+=parseInt(a.cash)),e}),Object(s.ab)("trx_pemabayran_ambil_pesanan",l),this.setState({status:!0,kembalian:a.kembalian})}}},{key:"render",value:function(){var a=this;return s.o.createElement(s.o.Fragment,null,s.o.createElement(E,{onSubmit:function(e){return a.simpanPembayaran(e)}}),s.o.createElement("hr",null),s.o.createElement("form",{onSubmit:this.props.handleSubmit,onKeyPress:function(a){"Enter"===a.key&&a.preventDefault()},autoComplete:"off"},s.o.createElement(s.u,{keyField:"jenis",exportCsv:!1,data:Object(s.H)("trx_pemabayran_ambil_pesanan")||[],columns:this.state.columns,empty:!0,pagination:"off",textEmpty:"Data Pembayaran Kosong"}),s.o.createElement("div",{className:"row"},s.o.createElement("div",{className:"col-12 text-right"},s.o.createElement("button",{className:"btn btn-primary",disabled:this.props.isLoadingPembayran,onClick:function(){return a.props.simpanPembayaran()},type:"button"},this.props.isLoadingPembayran?s.o.createElement(s.o.Fragment,null,s.o.createElement("i",{className:"fas fa-spinner fa-spin"})," \xa0 Sedang Diproses"):"Bayar Sekarang")))))}}]),t}(s.b);k=Object(s.Y)({form:"ModalPembayaran",enableReinitialize:!0,validate:d.a})(k);var v=Object(s.w)(function(a){var e=Object(s.H)("data_barang_pesanan")||[],t="PENJUALAN";return e.forEach(function(a){"-"===a.no_titip_group&&(t="PENJUALAN"),t="-"===a.no_pesanan?"PESANAN":"TITIPAN"}),{status:t}})(k),j=function(a){Object(o.a)(t,a);var e=Object(i.a)(t);function t(a){var r;return Object(n.a)(this,t),(r=e.call(this,a)).state={isLoading:!1,datapesanan:[],columns:[{dataField:"no_pesanan",text:"No Pesanan",footerAttrs:{colSpan:"3"},footer:"Total"},{dataField:"tanggal_transaksi",text:"Tgl Transaksi"},{dataField:"nama_customer",text:"Nama Customer"},{dataField:"no_hp",text:"Nomor HP"},{dataField:"total_harga",text:"Total Harga",formatter:function(a){return s.o.createElement("span",null,parseInt(a).toLocaleString("kr-KO"))}},{dataField:"jumlah_bayar",text:"Jumlah Pembayaran",formatter:function(a){return s.o.createElement("span",null,parseInt(a).toLocaleString("kr-KO"))}},{dataField:"action",text:"Action",csvExport:!1,headerClasses:"text-center",formatter:function(a,e,t){return s.o.createElement("div",{className:"row text-center"},s.o.createElement("div",{className:"col-12"},s.o.createElement("button",{type:"button",disabled:"DONE"===e.status_pesanan,"data-tooltip":"DONE"===e.status_pesanan?"Tidak Bisa Dibatal":"Batal Pesanan",onClick:function(){return r.batalPesanan(e)},className:"btn btn-danger mr-3"},s.o.createElement("i",{className:"fa fa-window-close"}))))},footer:""}]},r.handleSubmit=r.handleSubmit.bind(Object(l.a)(r)),r}return Object(r.a)(t,[{key:"ambilpesanan",value:function(a){var e=this,t=[];a.pembayaran.forEach(function(a){var e={jenis:a.jenis,keterangan:a.keterangan,nominal:a.jumlah_rp,status:"DONE"};t.push(e)}),Object(s.ab)("trx_pemabayran_ambil_pesanan",t),Object(c.i)("pesanan/ambil/no",{no_pesanan:a.no_pesanan}).then(function(a){Object(s.ab)("data_barang_ambil_pesanan",a.data),e.props.dispatch(Object(s.bb)())}).catch(function(a){Object(s.v)("info","Terjadi Kesalahaan Saat Request Data")})}},{key:"batalPesanan",value:function(a){var e=this;s.t.fire({title:"Anda Yakin !!",text:"Ingin Membatalkan Pesanan Ini ?",icon:"warning",position:"top-center",cancelButtonText:"Tidak",showCancelButton:!0,confirmButtonText:"OK",showConfirmButton:!0}).then(function(t){if(t.isConfirmed){var n=Object(s.H)("tgl_laporan");e.setState({isLoading:!0}),Object(c.n)("pesanan/cancel",{no_pesanan:a.no_pesanan}).then(function(a){e.setState({isLoading:!1}),Object(s.v)("success","Pesanan Berhasil Di Batal"),Object(c.e)("pesanan/"+n.tgl_awal+"/"+n.tgl_akhir).then(function(a){var t=[];a.data.forEach(function(a){var e={no_pesanan:a.no_pesanan,nama_customer:a.nama_customer,no_hp:a.no_hp,sisa_bayar:a.sisa_bayar,jumlah_bayar:a.jumlah_bayar,total_harga:a.total_harga,tanggal_transaksi:a.tanggal,detail_barang:a.detail_barang,pembayaran:a.pembayaran,status_pesanan:a.status_pesanan};t.push(e)}),e.setState({datapesanan:t,isLoading:!1})})}).catch(function(a){e.setState({isLoading:!1}),Object(s.v)("info",/conflict/i.test(a.response.data.message||"Error")?"Terjadi Kesalahan Saat Mengirim Data":a.response.data.message)})}})}},{key:"handleSubmit",value:function(a){var e=this;this.setState({isLoading:!0}),Object(c.e)("pesanan/"+a.tgl_awal+"/"+a.tgl_akhir).then(function(t){0===t.data.length&&Object(s.v)("info","Data Pesanan Tidak Ada");var n=[];t.data.forEach(function(a){var e={no_pesanan:a.no_pesanan,nama_customer:a.nama_customer,no_hp:a.no_hp,sisa_bayar:a.sisa_bayar,jumlah_bayar:a.jumlah_bayar,total_harga:a.total_harga,tanggal_transaksi:a.tanggal,detail_barang:a.detail_barang,pembayaran:a.pembayaran,status_pesanan:a.status_pesanan};n.push(e)});var r={tgl_awal:Object(s.B)(Object(s.R)(new Date(a.tgl_awal)).format("YYYY-MM-DD")),tgl_akhir:Object(s.B)(Object(s.R)(new Date(a.tgl_akhir)).format("YYYY-MM-DD"))};e.setState({isLoading:!1,datapesanan:n}),Object(s.ab)("tgl_laporan",r)}).catch(function(a){Object(s.v)("info",/conflict/i.test(a.response.data.message||"Error")?"Terjadi Kesalahan Saat Mengirim Data":a.response.data.message),e.setState({isLoading:!1})})}},{key:"render",value:function(){var a=this,e={renderer:function(a){return s.o.createElement("div",{className:"container"},s.o.createElement("div",{className:"row"},s.o.createElement("div",{className:"col-12"},"Detail Barang",s.o.createElement("table",null,s.o.createElement("tr",null,s.o.createElement("td",null," Kode Kategori "),s.o.createElement("td",null," Perkiraan Berat "),s.o.createElement("td",null," Perkiraan Kadar "),s.o.createElement("td",null," Harga / Gram "),s.o.createElement("td",null," Attribut "),s.o.createElement("td",null," Harga Attribut "),s.o.createElement("td",null," Kode Barcode "),s.o.createElement("td",null," Ongkos "),s.o.createElement("td",null," Total "),s.o.createElement("td",null," keterangan "),s.o.createElement("td",null," Deskripsi "),s.o.createElement("td",null," Deskripsi Contoh ")),a.detail_barang.map(function(a,e){return s.o.createElement(s.o.Fragment,null,s.o.createElement("tr",null,s.o.createElement("td",null," ",a.kode_kategori),s.o.createElement("td",null," ",a.perkiraan_berat.toFixed(3)),s.o.createElement("td",null," ",a.perkiraan_kadar),s.o.createElement("td",null," ",a.harga_gram.toLocaleString("kr-KO")),s.o.createElement("td",null," ",a.attribut),s.o.createElement("td",null," ",a.harga_atribut.toLocaleString("kr-KO")),s.o.createElement("td",null," ",a.kode_barcode),s.o.createElement("td",null," ",a.ongkos.toLocaleString("kr-KO")),s.o.createElement("td",null," ",a.sub_total.toLocaleString("kr-KO")),s.o.createElement("td",null," ",a.keterangan),s.o.createElement("td",null," ",a.deskripsi),s.o.createElement("td",null," ",a.deskripsi_contoh)))})))))},showExpandColumn:!0};return s.o.createElement("div",null,s.o.createElement("ol",{className:"breadcrumb float-xl-right"},s.o.createElement("li",{className:"breadcrumb-item"},s.o.createElement(s.h,{to:"#"},"Pesanan")),s.o.createElement("li",{className:"breadcrumb-item active"},"Lihat Pesanan")),s.o.createElement("h1",{className:"page-header"},"Lihat Pesanan "),s.o.createElement(s.l,null,s.o.createElement(s.n,null,"Lihat Pesanan"),s.o.createElement("br",null),s.o.createElement("div",{className:"container"},s.o.createElement(p,{isLoading:this.state.isLoading,onSubmit:function(e){return a.handleSubmit(e)}}),s.o.createElement(s.u,{keyField:"no_pesanan",exportCsv:!1,data:this.state.datapesanan,columns:this.state.columns,empty:!0,textEmpty:"Data Barang Kosong",expandRow:e})),s.o.createElement("br",null),s.o.createElement(s.j,{size:"l",title:"Form Pembayaran",content:s.o.createElement(v,{isLoadingPembayranTitipan:this.state.isLoadingPembayranTitipan,isLoadingPembayran:this.state.isLoadingPembayran,bayarTitipan:function(e){return a.bayarTitipan(e)},simpanPembayaran:function(e){return a.simpanPembayaranAmbilPesanan(e)}})})),this.state.isLoading?s.o.createElement(u.a,{loading:!0,background:"rgba(0, 0, 0, 0.35)",loaderColor:"rgba(94, 147, 117, 1)"}):null)}}]),t}(s.o.Component);j=Object(s.Y)({form:"LihatPesanan",enableReinitialize:!0})(j);e.default=Object(s.w)()(j)},693:function(a,e,t){"use strict";e.a=function(a){var e={};return a.jenis||(e.jenis="Jenis Tidak Boleh Kosong"),e}}}]);
//# sourceMappingURL=29.d1de013d.chunk.js.map