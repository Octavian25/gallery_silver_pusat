(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{1245:function(a,e,t){"use strict";t.r(e);var n=t(8),r=t(9),o=t(15),s=t(11),i=t(10),l=t(0),c=t(19),m=t(719),p=t(7),u=[{value:"MEMBER",name:"MEMBER"},{value:"NONMEMBER",name:"NON MEMBER"}],d=function(a){Object(s.a)(t,a);var e=Object(i.a)(t);function t(a){var r;return Object(n.a)(this,t),(r=e.call(this,a)).state={showMember:!0},r}return Object(r.a)(t,[{key:"componentDidMount",value:function(){this.props.dispatch(Object(p.Ab)());var a=0===Object(l.P)("data_customer_tmp").length?[]:JSON.parse(Object(l.P)("data_customer_tmp")||[]);a&&"MEMBER"===a.jenis_pelanggan?this.setState({showMember:!1}):(this.setState({showMember:!0}),this.props.change("jenis_pelanggan","NONMEMBER"))}},{key:"changemember",value:function(a){"MEMBER"===a?(this.setState({showMember:!1}),document.getElementById("kode_member").focus(),this.props.change("kode_customer","")):(this.props.change("kode_customer","NONMEMBER"),document.getElementById("nama_customer").focus(),this.props.change("nama_customer",""),this.props.change("no_hp",""),this.props.change("alamat_customer",""),this.setState({showMember:!0}))}},{key:"getMember",value:function(a){var e=this;Object(l.D)("member/get/by-kode-member/"+a).then(function(a){0===a.data.length?Object(l.v)("info","Member Yang Anda Masukan Tidak Ada !!!"):a.data.forEach(function(a,t){e.props.change("nama_customer",a.nama_customer),e.props.change("no_hp",a.no_hp),e.props.change("alamat_customer",a.alamat_customer)})}).catch(function(a){Object(l.v)("info","Terjadi Kesalahan SIlahkan Ulangi Kembali !!!")})}},{key:"render",value:function(){var a=this;return l.o.createElement("form",{onSubmit:this.props.handleSubmit,onKeyPress:function(a){"Enter"===a.key&&a.preventDefault()},autoComplete:"off"},l.o.createElement("div",{className:"row"},l.o.createElement("div",{className:"col-4"},l.o.createElement(l.d,{name:"kode_sales",label:"Pilih Kode Sales",placeholder:"Masukan Kode Sales",options:this.props.DataSales.filter(function(a){return void 0!==a.kode_sales}).map(function(a){return{value:a.kode_sales,name:a.kode_sales}}),component:l.r})),l.o.createElement("div",{className:"col-4"},l.o.createElement(l.d,{id:"jenis_pelanggan",name:"jenis_pelanggan",label:"Pilih Pelanggan",onChange:function(e){return a.changemember(e)},placeholder:"Silahkan Pilih Pelanggan",options:u,component:l.r})),l.o.createElement("div",{className:"col-4"},l.o.createElement(l.d,{id:"kode_member",name:"kode_customer",onChange:function(e){return a.getMember(e.target.value)},component:l.q,type:"text",readOnly:this.state.showMember,label:"Kode Customer",placeholder:"Masukan Kode Customer"})),l.o.createElement("div",{className:"col-4"},l.o.createElement(l.d,{id:"nama_customer",name:"nama_customer",component:l.q,type:"text",label:"Nama Customer",placeholder:"Masukan Nama Customer"})),l.o.createElement("div",{className:"col-4"},l.o.createElement(l.d,{name:"no_hp",component:l.q,type:"text",normalize:l.k,label:"No Hp",placeholder:"Masukan No Hp"})),l.o.createElement("div",{className:"col-4"},l.o.createElement(l.d,{name:"alamat_customer",component:l.q,type:"textarea",label:"Alamat Customer",placeholder:"Masukan Alamat Customer"}))),l.o.createElement("div",{className:"row"},l.o.createElement("div",{className:"col-8"}),l.o.createElement("div",{className:"col-4"},l.o.createElement("button",{className:"btn btn-primary btn-block",disabled:this.props.isLoadingDataCustomer,type:"submit"},this.props.isLoadingDataCustomer?l.o.createElement(l.o.Fragment,null,l.o.createElement("i",{className:"fas fa-spinner fa-spin"})," \xa0 Sedang Menyimpan"):"Simpan Data"))))}}]),t}(l.b);d=Object(l.Y)({form:"ModalDataCustomer",enableReinitialize:!0,validate:m.a})(d);var b=Object(l.w)(function(a){var e=0===Object(l.P)("data_customer_tmp").length?[]:JSON.parse(Object(l.P)("data_customer_tmp")||[]);return{initialValues:{kode_sales:e.kode_sales||"",jenis_pelanggan:e.jenis_pelanggan||"",kode_customer:e.kode_customer||"",nama_customer:e.nama_customer||"",no_hp:e.no_hp||"",alamat_customer:e.alamat_customer||""},DataSales:a.datamaster.getDataSales}})(d),h=t(693),_=Object(l.y)({prefix:"Rp. ",locale:"kr-KO"}),g=[{value:"CASH",name:"CASH"},{value:"DEBET",name:"DEBET"},{value:"TRANSFER",name:"TRANSFER"},{value:"CREDIT",name:"CREDIT"}],k=function(a){Object(s.a)(t,a);var e=Object(i.a)(t);function t(a){var r;return Object(n.a)(this,t),(r=e.call(this,a)).state={isLoading:!1,type_pembayaran:"CASH",lebih:!1,columns:[{dataField:"type",text:"Type",footerAttrs:{colSpan:"1"},footer:"Grand Total"},{dataField:"Total",text:"Total",footer:""}]},r.setStartDate=r.setStartDate.bind(Object(o.a)(r)),r}return Object(r.a)(t,[{key:"componentDidMount",value:function(){var a=this;this.props.dispatch(Object(p.Ab)());var e=JSON.parse(Object(l.P)("data_barang_pesanan")),t=0;e.forEach(function(e,n){t+=e.sub_total,a.props.change("grand_total_pembayaran",t),a.props.change("harus_bayar_rp",t)}),this.props.change("jenis","CASH"),setTimeout(function(){document.getElementById("cash_trx_penjualan").focus()},100)}},{key:"hitungTotal",value:function(){this.props.change("kembali",this.props.kembali),this.props.change("nominal_kembali",this.props.nominal_kembali)}},{key:"pilihPembyaran",value:function(a){"CASH"===a?this.setState({type_pembayaran:"CASH"}):"TRANSFER"===a?this.setState({type_pembayaran:"TRANSFER"}):"DEBET"===a?this.setState({type_pembayaran:"DEBET"}):this.setState({type_pembayaran:"CREDIT"}),this.props.change("cash","")}},{key:"setStartDate",value:function(a){this.setState({tgl_awal:new Date(a)})}},{key:"copyValue",value:function(a){this.props.change("cash",parseInt(Object(l.k)(a)))}},{key:"render",value:function(){var a=this;return l.o.createElement("form",{onSubmit:this.props.handleSubmit,onKeyPress:function(a){"Enter"===a.key&&a.preventDefault()},autoComplete:"off"},l.o.createElement("div",{className:"row"},l.o.createElement("div",{className:"col-6"},l.o.createElement(l.d,Object.assign({name:"grand_total_pembayaran",component:l.q,type:"text",onChange:this.hitungTotal(),readOnly:!0},_,{label:"Total Harga Jual",placeholder:"Total Harga Jual"}))),l.o.createElement("div",{className:"col-6"},l.o.createElement(l.d,Object.assign({id:"harus_bayar_rp",name:"harus_bayar_rp",component:l.q,type:"text",onChange:this.hitungTotal(),readOnly:!0},_,{label:"Harus Bayar Rp",placeholder:"Harus Bayar Rp"}))),l.o.createElement("div",{className:"col-6"},l.o.createElement(l.d,{name:"jenis",label:"Pilih Jenis Bayar",placeholder:"Pilih Jenis Pembayaran",options:g,onChange:function(e){return a.pilihPembyaran(e)},component:l.r})),l.o.createElement("div",{className:"col-6",style:{display:"CASH"===this.state.type_pembayaran?"none":(this.state.type_pembayaran,"block")}},l.o.createElement(l.d,{tabIndex:"1",name:"nama_bank",id:"nama_bank",component:l.q,type:"text",label:"Bank",placeholder:"Masukan Nama Bank"})),l.o.createElement("div",{className:"col-6",style:{display:"CASH"===this.state.type_pembayaran?"none":"DEBET"===this.state.type_pembayaran?"none":"block"}},l.o.createElement(l.d,{tabIndex:"1",name:"no_card",id:"no_card",component:l.q,type:"text",label:"TRANSFER"===this.state.type_pembayaran?"No Rek":"Card No",placeholder:"TRANSFER"===this.state.type_pembayaran?"Masukan No Rek":"Masukan Card No"})),l.o.createElement("div",{className:"col-6"},l.o.createElement(l.d,Object.assign({tabIndex:"1",name:"cash",id:"cash_trx_penjualan",component:l.q,type:"text",label:"Nominal",onChange:this.hitungTotal()},_,{normalize:l.k,placeholder:"Masukan Nominal"}))),l.o.createElement("div",{className:"col-6",style:{display:"CREDIT"===this.state.type_pembayaran?"block":"none"}},l.o.createElement(l.d,{tabIndex:"1",name:"fee",id:"fee",component:l.q,type:"text",label:"Fee (%)",normalize:l.k,placeholder:"5"})),l.o.createElement("div",{className:"col-6 d-none"},l.o.createElement(l.d,{tabIndex:"1",name:"nominal_kembali",component:l.q,type:"text",label:"Nominal",placeholder:"Masukan Nominal"})),l.o.createElement("div",{className:"col-6"},l.o.createElement(l.d,{name:"kembali",id:"sisa_bayar",component:l.q,type:"text",readOnly:!0,label:"Sisa",onFocus:function(e){return a.copyValue(e.target.value)},placeholder:"Sisa Pembayaran"})),l.o.createElement("div",{className:"CASH"===this.state.type_pembayaran?"col-6 text-right":"TRANSFER"===this.state.type_pembayaran?"col-6 text-right":"col-12 text-right"},l.o.createElement("br",null),l.o.createElement("label",null,"\xa0"),l.o.createElement("button",{tabIndex:"2",disabled:this.props.notif,className:"btn btn-primary"}," ",l.o.createElement("i",{className:"fa fa-plus"}))),l.o.createElement("div",{className:"col-12"},l.o.createElement(l.d,{name:"estimasi_pesanan",component:l.g,type:"text",label:"Estimasi Pesanan Selesai",defaultValue:Object(l.I)(),selected:this.state.tgl_awal,onChange:function(e){return a.setStartDate(e)},placeholder:"Estimasi Pesanan"}))))}}]),t}(l.b);k=Object(l.Y)({form:"HeadInputPembayaran",enableReinitialize:!0,validate:h.a})(k);var f=Object(l.A)("HeadInputPembayaran"),y=Object(l.w)(function(a){var e=f(a,"grand_total_pembayaran","harus_bayar_rp","cash"),t=e.cash,n=e.harus_bayar_rp,r=JSON.parse(localStorage.getItem("trx_pemabayaran_pesanan"))||[],o=0;r.forEach(function(a){o=a.nominal+o});var s=parseFloat(o||0)-parseFloat(n||0);return{kembali:s.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),nominal_kembali:s+parseInt(t),initialValues:{estimasi_pesanan:Object(l.I)()}}})(k),E=t(66),v=t.n(E),j=function(a){Object(s.a)(t,a);var e=Object(i.a)(t);function t(a){var r;return Object(n.a)(this,t),(r=e.call(this,a)).state={isLoading:!1,type_pembayaran:"CASH",columns:[{dataField:"jenis",text:"Jenis",footerAttrs:{colSpan:"2"},footer:"Grand Total"},{dataField:"keterangan",text:"Keterangan"},{dataField:"nominal",text:"Total",formatter:function(a){return l.o.createElement("span",null,parseInt(a).toLocaleString("kr-KO"))},footer:function(a){return parseInt(a.reduce(function(a,e){return a+e},0)).toLocaleString("kr-KO")}},{dataField:"action",text:"Action",csvExport:!1,headerClasses:"text-center",formatter:function(a,e,t){return l.o.createElement("div",{className:"row text-center"},l.o.createElement("div",{className:"col-12"},l.o.createElement("button",{type:"button",disabled:"TITIPAN"===e.keterangan,onClick:function(){return r.hapusdata(t)},className:"btn btn-danger mr-3"},l.o.createElement("i",{className:"fa fa-trash"}))))},footer:""}]},r}return Object(r.a)(t,[{key:"hapusdata",value:function(a){var e=this;l.t.fire({title:"Anda Yakin !!",text:"Ingin Menghapus Data Ini ?",icon:"warning",position:"top-center",cancelButtonText:"Tidak",showCancelButton:!0,confirmButtonText:"OK",showConfirmButton:!0}).then(function(t){if(t.isConfirmed){var n=Object(l.H)("trx_pemabayaran_pesanan");n.splice(a,1),Object(l.ab)("trx_pemabayaran_pesanan",n),e.setState({status:"berhasil"})}})}},{key:"simpanPembayaran",value:function(a){if(void 0===a.no_card&&"CASH"!==a.jenis&&"DEBET"!==a.jenis)return Object(l.v)("info","Nomor kartu tidak boleh kosong"),!1;if(void 0===a.nama_bank&&"CASH"!==a.jenis)return Object(l.v)("info","Nama Bank tidak boleh kosong"),!1;if(void 0===a.cash||"0"===a.cash)return Object(l.v)("info","Nominal tidak boleh kosong"),!1;var e={total_transaksi:a.harus_bayar_rp,sisa_bayar:a.nominal_kembali};Object(l.ab)("sisa_bayar_pesanan",e);var t=JSON.parse(localStorage.getItem("trx_pemabayaran_pesanan"))||[];if("CASH"===a.jenis||t.length){if("CASH"!==a.jenis){if(a.kembali.replace(/[^0-9]/g,"")-a.cash<0&&0!==parseInt(a.kembali))return Object(l.v)("info","Pembayaran tidak boleh lebih dari sisa"),!1;if(t.reduce(function(a,e){return a+e.nominal},0)>=a.harus_bayar_rp)return Object(l.v)("info","Pembayaran Sudah Cukup"),!1}}else if(a.kembali.replace(/[^0-9]/g,"")-a.cash<0)return Object(l.v)("info","Pembayaran tidak boleh lebih dari sisa"),!1;if(t.findIndex(function(a){return"CASH"===a.jenis})>=0){if(a.kembali.replace(/[^0-9]/g,"")-a.cash<0&&t.reduce(function(a,e){return a+e.nominal},0)>a.harus_bayar_rp)return Object(l.v)("info","Pembayaran Sudah Cukup"),!1;if(t.reduce(function(a,e){return a+e.nominal},0)>=a.harus_bayar_rp)return Object(l.v)("info","Pembayaran Sudah Cukup"),!1}if(Object(l.ab)("estimasi_pesanan",Object(l.B)(Object(l.R)(new Date(a.estimasi_pesanan)).format("YYYY-MM-DD"))),-1===t.findIndex(function(e){return e.jenis===a.jenis})){var n="";n="CASH"===a.jenis?"CASH":"TRANSFER"===a.jenis?a.no_card+" - "+a.nama_bank:a.nama_bank;var r={jenis:a.jenis,nominal:parseInt(a.cash||0),nama_bank:void 0!==a.nama_bank?a.nama_bank.toUpperCase():"-",fee:"CREDIT"===a.jenis&&a.fee||0,no_card:a.no_card||"-",keterangan:n.toUpperCase()};t.push(r),this.setState({masuk:!0}),Object(l.ab)("trx_pemabayaran_pesanan",t)}else{var o=Object(l.H)("trx_pemabayaran_pesanan");o=o.map(function(e){return e.jenis===a.jenis&&(e.nominal+=parseInt(a.cash)),e}),Object(l.ab)("trx_pemabayaran_pesanan",o),this.setState({status:!0})}}},{key:"render",value:function(){var a=this;return l.o.createElement(l.o.Fragment,null,l.o.createElement(y,{onSubmit:function(e){return a.simpanPembayaran(e)}}),l.o.createElement("hr",null),l.o.createElement("form",{onSubmit:this.props.handleSubmit,onKeyPress:function(a){"Enter"===a.key&&a.preventDefault()},autoComplete:"off"},l.o.createElement(l.u,{keyField:"jenis",exportCsv:!1,data:Object(l.H)("trx_pemabayaran_pesanan")||[],columns:this.state.columns,empty:!0,pagination:"off",textEmpty:"Data Pembayaran Kosong"}),l.o.createElement("div",{className:"row"},l.o.createElement("div",{className:"col-6"}),l.o.createElement("div",{className:"col-6 text-right"},l.o.createElement("button",{className:"btn btn-primary",disabled:this.props.isLoadingPembayranTitipan,onClick:function(){return a.props.bayarSekarang()},type:"button"},this.props.isLoadingPembayranTitipan?l.o.createElement(l.o.Fragment,null,l.o.createElement("i",{className:"fas fa-spinner fa-spin"})," \xa0 Sedang Diproses"):"Bayar Sekarang"))),this.props.isLoadingPembayranTitipan?l.o.createElement(v.a,{loading:!0,background:"rgba(0, 0, 0, 0.35)",loaderColor:"rgba(94, 147, 117, 1)"}):null))}}]),t}(l.b);j=Object(l.Y)({form:"ModalPembayaran",enableReinitialize:!0,validate:h.a})(j);var O=Object(l.w)(function(a){var e=Object(l.H)("data_barang_penjualan_tmp")||[],t="PENJUALAN";return e.forEach(function(a){t="-"===a.no_titip_group?"PENJUALAN":"TITIPAN"}),{status:t}})(j),N=t(5),S=Object(l.y)({prefix:"Rp. ",locale:"kr-KO"}),C=function(a){Object(s.a)(t,a);var e=Object(i.a)(t);function t(a){var r;return Object(n.a)(this,t),(r=e.call(this,a)).state={isLoading:!1,bawa_sendiri:!1,dari_toko:!0,isChecked:!0,kategori_harga:!0},r}return Object(r.a)(t,[{key:"componentDidMount",value:function(){var a=this;this.props.dispatch(Object(p.y)()),setTimeout(function(){Object(c.d)("para-system/key/kategori_harga").then(function(e){"harga_100%"===e.data.value?a.setState({kategori_harga:!0}):a.setState({kategori_harga:!1}),a.props.change("kadar",a.state.kategori_harga?0:100)})},200)}},{key:"hitungTotal",value:function(){this.props.change("sub_total",this.props.sub_total)}},{key:"chnageValue",value:function(a){"dari_toko"===a.target.value?(document.getElementById("kode_dari_toko").focus(),this.props.change("deskripsi_bawa_sediri",""),this.props.change("berat_bawa_sendiri",""),this.setState({dari_toko:!1,bawa_sendiri:!0,isChecked:!1})):(document.getElementById("deskripsi_bawa_sediri").focus(),this.props.change("kode_dari_toko",""),this.props.change("deskripsi_dari_toko",""),this.props.change("berat_dari_toko",""),this.setState({dari_toko:!0,bawa_sendiri:!1,isChecked:!0}))}},{key:"getBarcode",value:function(a){var e=this;Object(l.D)("barang/get/by-kode-barcode/"+a).then(function(a){a.data.forEach(function(a){e.props.change("deskripsi_dari_toko",a.nama_barang),e.props.change("berat_dari_toko",a.berat)})}).catch(function(a){404!==a.response.status&&Object(l.v)("info",a.response.data)})}},{key:"hideModal",value:function(){this.props.dispatch(Object(p.Mb)())}},{key:"setIndex",value:function(a){var e=this;document.getElementById("jenis_barang").focus(),Object(l.D)("group/get/by-kode-group/"+a).then(function(a){e.props.change("harga_pergram",a.data.harga)})}},{key:"render",value:function(){var a=this;return l.o.createElement("form",{onSubmit:this.props.handleSubmit,onKeyPress:function(a){"Enter"===a.key&&a.preventDefault()},autoComplete:"off"},l.o.createElement("div",{className:"row"},l.o.createElement("div",{className:"col-2"},l.o.createElement(l.d,{name:"kode_group",label:"Kategori",onChange:function(e){return a.setIndex(e)},placeholder:"Pilih Kategori",options:this.props.DataGroup.filter(function(a){return void 0!==a.kode_group}).map(function(a){return{value:a.kode_group,name:a.kode_group}}),component:l.r})),l.o.createElement("div",{className:"col-4"},l.o.createElement(l.d,{id:"jenis_barang",name:"jenis_barang",component:l.q,type:"text",label:"Nama Barang",placeholder:"Masukan Nama Barang"})),l.o.createElement("div",{className:"col-2"},l.o.createElement(l.d,{id:"betat",name:"berat",component:l.q,type:"text",onChange:this.hitungTotal(),normalize:l.e,label:"Berat",placeholder:"Masukan Berat"})),l.o.createElement("div",{className:this.state.kategori_harga?"col-lg-2":"col-lg-2 d-none"},l.o.createElement(l.d,{id:"kadar",name:"kadar",component:l.q,type:"text",onChange:this.hitungTotal(),normalize:l.k,label:"Kadar",placeholder:"Masukan Kadar"})),l.o.createElement("div",{className:this.state.kategori_harga?"col-lg-2":"col-lg-4"},l.o.createElement(l.d,Object.assign({name:"harga_pergram",component:l.q,type:"text",onChange:this.hitungTotal()},S,{label:"Harga / Gram",placeholder:"Masukan Harga / Gram"}))),l.o.createElement("div",{className:"col-6"},l.o.createElement(l.d,{id:"atribut",name:"atribut",component:l.q,type:"text",label:"Atribut",placeholder:"Masukan Atribut"})),l.o.createElement("div",{className:"col-2"},l.o.createElement(l.d,Object.assign({name:"harga_atribut",component:l.q,type:"text"},S,{label:"Harga Atribut",onChange:this.hitungTotal(),placeholder:"Masukan Harga"}))),l.o.createElement("div",{className:"col-2"},l.o.createElement(l.d,Object.assign({name:"ongkos",component:l.q,type:"text"},S,{onChange:this.hitungTotal(),label:"Ongkos",placeholder:"Masukan Ongkos"}))),l.o.createElement("div",{className:"col-2"},l.o.createElement(l.d,Object.assign({name:"sub_total",component:l.q,type:"text"},S,{readOnly:!0,label:"Sub Total",placeholder:"Masukan Sub Total"}))),l.o.createElement("div",{className:"col-12"},l.o.createElement(l.d,{name:"deskripsi_pesanan",component:l.q,type:"text",label:"Deskripsi",placeholder:"Masukan Deskripsi"})),l.o.createElement("div",{className:"col-2"},l.o.createElement("div",{className:"form-group"},l.o.createElement("label",null,"\xa0"),l.o.createElement("br",null),l.o.createElement("label",null,l.o.createElement(l.d,{name:"options_value",component:"input",onClick:function(e){return a.chnageValue(e)},type:"radio",checked:this.state.isChecked,value:"bawa_sendiri"})," ","Bawa Sendiri"))),l.o.createElement("div",{className:"col-7"},l.o.createElement(l.d,{id:"deskripsi_bawa_sediri",name:"deskripsi_bawa_sediri",component:l.q,type:"text",readOnly:this.state.bawa_sendiri,label:"Deskripsi",placeholder:"Masukan Deskripsi"})),l.o.createElement("div",{className:"col-3"},l.o.createElement(l.d,{readOnly:this.state.bawa_sendiri,name:"berat_bawa_sendiri",component:l.q,type:"text",normalize:l.e,label:"Berat",placeholder:"Masukan Berat"})),l.o.createElement("div",{className:"col-2"},l.o.createElement("div",{className:"form-group"},l.o.createElement("label",null,"\xa0"),l.o.createElement("br",null),l.o.createElement("label",null,l.o.createElement(l.d,{name:"options_value",component:"input",type:"radio",onClick:function(e){return a.chnageValue(e)},value:"dari_toko"})," ","Dari Toko"))),l.o.createElement("div",{className:"col-3"},l.o.createElement(l.d,{id:"kode_dari_toko",name:"kode_dari_toko",onChange:function(e){return a.getBarcode(e.target.value)},component:l.q,type:"text",label:"Kode Barcode",readOnly:this.state.dari_toko,placeholder:"Masukan Kode Barcode"})),l.o.createElement("div",{className:"col-4"},l.o.createElement(l.d,{name:"deskripsi_dari_toko",component:l.q,type:"text",label:"Deskripsi",readOnly:!0,placeholder:"Masukan Deskripsi"})),l.o.createElement("div",{className:"col-3"},l.o.createElement(l.d,{name:"berat_dari_toko",component:l.q,type:"text",normalize:l.e,label:"Berat",readOnly:!0,placeholder:"Masukan Berat"})),l.o.createElement("div",{className:"col-6"},l.o.createElement("button",{className:"btn btn-warning",type:"button",onClick:function(){return a.hideModal()}}," ","Close"," ")),l.o.createElement("div",{className:"col-6 text-right"},l.o.createElement("button",{className:"btn btn-primary"}," Add "))))}}]),t}(l.o.Component);C=Object(l.Y)({form:"ModalTambahBarangPesanan",enableReinitialize:!0})(C);var M=Object(l.w)(function(a){var e=Object(l.A)("ModalTambahBarangPesanan")(a,"kadar","berat","harga_pergram","ongkos","harga_atribut"),t=e.ongkos,n=e.kadar,r=e.harga_pergram,o=e.berat,s=e.harga_atribut,i=Object(N.p)(parseInt(r||0)*parseInt(n||0)/parseInt(100)*parseFloat(o||0)),c=parseInt(i||0)+parseInt(t||0)+parseInt(s||0);return{DataGroup:a.datamaster.GetDataGroup,sub_total:parseFloat(c)}})(C),x=function(a){Object(s.a)(t,a);var e=Object(i.a)(t);function t(a){var r;return Object(n.a)(this,t),(r=e.call(this,a)).state={isLoading:!1,loadingreset:!1,FormModal:"",isLoadingPembayranTitipan:!1,isLoadingPembayran:!1,columns:[{dataField:"kode_kategori",text:"Kategori",footerAttrs:{colSpan:"5"},footer:"Total"},{dataField:"kode_barcode",text:"Kode Barcode"},{dataField:"keterangan",text:"Nama Barang"},{dataField:"perkiraan_berat",text:"Perkiraan Berat"},{dataField:"perkiraan_kadar",text:"Perkiraan Kadar"},{dataField:"harga_gram",text:"Harga / Gram",formatter:function(a){return l.o.createElement("span",null,parseInt(a).toLocaleString("kr-KO"))},footer:function(a){return parseInt(a.reduce(function(a,e){return a+e},0)).toLocaleString("kr-KO")}},{dataField:"sub_total",text:"Sub Total",formatter:function(a){return l.o.createElement("span",null,parseInt(a).toLocaleString("kr-KO"))},footer:function(a){return parseInt(a.reduce(function(a,e){return a+e},0)).toLocaleString("kr-KO")}},{dataField:"action",text:"Action",csvExport:!1,headerClasses:"text-center",formatter:function(a,e,t){return l.o.createElement("div",{className:"row text-center"},l.o.createElement("div",{className:"col-12"},l.o.createElement("button",{type:"button",onClick:function(){return r.hapusdata(t,e)},className:"btn btn-danger mr-3"},l.o.createElement("i",{className:"fa fa-trash"}))))},footer:""}]},r.handleSubmit=r.handleSubmit.bind(Object(o.a)(r)),r}return Object(r.a)(t,[{key:"handleSubmit",value:function(a){var e=this,t={alamat_customer:a.alamat_customer||"-",jenis_pelanggan:a.jenis_pelanggan||"NONMEMBER",kode_customer:"NONMEMBER"===a.jenis_pelanggan?"NONMEMBER":a.kode_customer,kode_sales:a.kode_sales,nama_customer:a.nama_customer||"REGULER",no_hp:a.no_hp||"-"};Object(l.Q)("data_customer_tmp",JSON.stringify(t)),this.setState({isLoadingDataCustomer:!0}),setTimeout(function(){e.setState({isLoadingDataCustomer:!1}),e.props.dispatch(Object(l.K)())},500)}},{key:"ShowModalCustomer",value:function(){this.setState({FormModal:"ShowModalCustomer"}),this.props.dispatch(Object(l.bb)())}},{key:"ShowModalBarang",value:function(){this.setState({FormModal:"ShowModalBarang"}),this.props.dispatch(Object(l.bb)())}},{key:"simpanBarang",value:function(a){var e=[],t={kode_kategori:a.kode_group,perkiraan_berat:parseFloat(a.berat),perkiraan_kadar:parseInt(a.kadar),harga_gram:parseInt(a.harga_pergram),attribut:a.atribut||"-",harga_atribut:parseInt(a.harga_atribut||0),ongkos:parseInt(a.ongkos||0),sub_total:parseInt(a.sub_total),keterangan:a.jenis_barang||"-",deskripsi:a.deskripsi_pesanan||"-",barang_contoh_internal:"dari_toko"===a.options_value,kode_barcode:a.kode_dari_toko||"-",deskripsi_contoh:"dari_toko"===a.options_value?a.deskripsi_dari_toko||"-":a.deskripsi_bawa_sediri||"-",berat_barang_contoh:"dari_toko"===a.options_value?a.berat_dari_toko||0:a.berat_bawa_sendiri||0};e.push(t),Object(l.ab)("data_barang_pesanan",e),this.setState({status:!0}),this.props.dispatch(Object(l.Z)("ModalTambahBarangPesanan")),this.props.dispatch(Object(l.K)())}},{key:"hapusdata",value:function(a,e){var t=this;l.t.fire({title:"Anda Yakin !!",text:"Ingin Menghapus Data Ini ?",icon:"warning",position:"top-center",cancelButtonText:"Tidak",showCancelButton:!0,confirmButtonText:"OK",showConfirmButton:!0}).then(function(e){if(e.isConfirmed){var n=Object(l.H)("data_barang_pesanan");n.splice(a,1),Object(l.ab)("data_barang_pesanan",n),t.setState({status:"berhasil"})}})}},{key:"bayarSekarang",value:function(){var a=this;this.setState({isLoadingPembayranTitipan:!0});var e=Object(l.H)("estimasi_pesanan"),t=Object(l.H)("trx_pemabayaran_pesanan"),n=[],r=0,o=0;t.forEach(function(a){"CASH"===a.jenis?(o=parseInt(a.nominal)<=Math.abs(parseInt(Object(l.H)("sisa_bayar_pesanan").sisa_bayar))?Math.abs(parseInt(Object(l.H)("sisa_bayar_pesanan").sisa_bayar)-parseInt(a.nominal)):parseInt(a.nominal),o=parseInt(a.nominal)>=Math.abs(parseInt(Object(l.H)("sisa_bayar_pesanan").total_transaksi))?parseInt(a.nominal)-Math.abs(parseInt(Object(l.H)("sisa_bayar_pesanan").sisa_bayar)):parseInt(a.nominal)):o=parseInt(a.nominal);var e={jenis:a.jenis,keterangan:a.keterangan,fee:"CREDIT"===a.jenis&&parseInt(a.fee)||0,jumlah_rp:o};r=a.nominal+r,n.push(e)});var s=JSON.parse(Object(l.P)("data_customer_tmp")),i=Object(l.H)("data_barang_pesanan"),m=[],p=0;i.forEach(function(a,e){p=a.sub_total+p;var t={kode_kategori:a.kode_kategori,perkiraan_berat:parseFloat(a.perkiraan_berat),perkiraan_kadar:parseInt(a.perkiraan_kadar),harga_gram:parseInt(a.harga_gram),attribut:a.attribut||"-",kode_barcode:a.kode_barcode||"-",harga_atribut:parseInt(a.harga_atribut),ongkos:parseInt(a.ongkos||0),sub_total:parseInt(a.sub_total),keterangan:a.keterangan||"-",deskripsi:a.deskripsi||"-",barang_contoh_internal:a.barang_contoh_internal||!1,deskripsi_contoh:a.deskripsi_contoh||"-",berat_barang_contoh:parseFloat(a.berat_barang_contoh)};m.push(t)});var u={status:"PESANAN",estimasi_tanggal:e,kode_sales:s.kode_sales,kode_customer:"NONMEMBER"===s.jenis_pelanggan?s.jenis_pelanggan:s.kode_customer,nama_customer:s.nama_customer,alamat_customer:s.alamat_customer,no_hp:s.no_hp,detail_barang:m,pembayaran:n,total_harga:p,jumlah_bayar:r,sisa_bayar:Math.abs(parseInt(p)-parseInt(r))};Object(c.h)("pesanan/create",u).then(function(e){if(Object(l.ab)("data_barang_pesanan",[]),Object(l.v)("success","Transaksi Pesanan Berhasil"),0!==e.data.length){for(var t=[],n=0;n<2;n++){var r="";r+="========================================\n",r+="               NOTA PESANAN             \n",r+="========================================\nTanggal          : ".concat(e.data.tanggal,"\nNama Customer    : ").concat(e.data.nama_customer,"\nNo Hp            : ").concat(e.data.no_hp,"\n"),r+="========================================\n",r+="Keterangan\n",r+="========================================\n",e.data.detail_barang.forEach(function(a,t){r+="No Faktur Pesanan  : ".concat(e.data.no_pesanan,"\n"),r+="Dp                 : ".concat(e.data.dp.toLocaleString("kr-KO"),"\n"),r+="Estimasi Pesanan   : ".concat(e.data.estimasi_tanggal,"\n"),r+="========================================\n",r+="                               TTD      \n",r+="                                        \n",r+="                                        \n",r+="                                        \n",r+="                         (             )\n",r+="                                        \n",r+="                                        \n",r+="                                        \n"}),t.push(r)}document.getElementById("nota_pesanan").value=t.join(""),setTimeout(function(){a.TextFilenotapesanan()},100)}}).then(function(){a.props.dispatch(Object(l.K)())}).then(function(){a.props.dispatch(Object(l.Z)("ModalPembayaran"))}).then(function(){Object(l.ab)("data_barang_pesanan",[]),Object(l.ab)("trx_pemabayaran_pesanan",[]),Object(l.ab)("data_customer_tmp",[]),Object(l.ab)("estimasi_pesanan",[])}).then(function(){a.setState({isLoadingPembayranTitipan:!1})}).catch(function(e){a.setState({isLoadingPembayranTitipan:!1}),Object(l.v)("info",void 0===e.response?"Terjadi Kesalahan Saat Request Data, Silahkan Ulangi Lagi":e.response.data.message||"Terjadi Kesalahan Saat Request Data, Silahkan Ulangi Lagi")})}},{key:"showModalPembayaran",value:function(){var a=Object(l.H)("data_customer_tmp")||[],e=Object(l.H)("data_barang_pesanan")||[];0===a.length||0===e.length?Object(l.v)("info","Data Customer Atau Data Barang Belum Diisi !!!"):(this.setState({FormModal:"ShowModalPembayaran"}),this.props.dispatch(Object(l.bb)()))}},{key:"TextFilenotapesanan",value:function(){var a=document.createElement("a"),e=new Blob([document.getElementById("nota_pesanan").value],{type:"text/plain;charset=utf-8"});a.href=URL.createObjectURL(e),a.download="autoprint_pesanan.txt",document.body.appendChild(a),a.click()}},{key:"reset",value:function(){var a=this;this.setState({loadingreset:!0}),setTimeout(function(){Object(l.ab)("data_barang_pesanan",[]),Object(l.ab)("trx_pemabayaran_pesanan",[]),Object(l.ab)("data_customer_tmp",[]),Object(l.ab)("estimasi_pesanan",[]),a.setState({loadingreset:!1})},100)}},{key:"render",value:function(){var a=this,e={renderer:function(a){return l.o.createElement("div",{className:"container"},l.o.createElement("div",{className:"row"},l.o.createElement("div",{className:"col-12"},"Ongkos : ",a.ongkos.toLocaleString("kr-KO")," ",l.o.createElement("br",null),"Nama Atribut : ",a.attribut," ",l.o.createElement("br",null),"Harga Atribut : ",a.harga_atribut.toLocaleString("kr-KO")," ",l.o.createElement("br",null),"Betar Barang Contoh : ",a.berat_barang_contoh," ",l.o.createElement("br",null),"Deskripsi Contoh : ",a.deskripsi_contoh," ",l.o.createElement("br",null),"Deskripsi Pesanan : ",a.deskripsi," ",l.o.createElement("br",null))))},showExpandColumn:!0,expandByColumnOnly:!0};return l.o.createElement("div",null,l.o.createElement("ol",{className:"breadcrumb float-xl-right"},l.o.createElement("li",{className:"breadcrumb-item"},l.o.createElement(l.h,{to:"#"},"Pesanan")),l.o.createElement("li",{className:"breadcrumb-item active"},"Transaksi Pesanan")),l.o.createElement("h1",{className:"page-header"},"Transaksi Pesanan "),l.o.createElement("textarea",{style:{display:"none"},id:"nota_pesanan",rows:"100",cols:"100"}),l.o.createElement(l.l,null,l.o.createElement(l.n,null,"Transaksi Pesanan"),l.o.createElement("br",null),l.o.createElement(l.m,null,l.o.createElement(l.u,{keyField:"kode_barcode",exportCsv:!1,data:Object(l.H)("data_barang_pesanan")||[],tambahData:!0,btnText:"Data Customer",columns:this.state.columns,btnOptional:!0,namaCustomer:!0,jenisCustomer:!0,form:"Penjualan",btnTextOptional:"Data Barang",handleClick:function(){return a.ShowModalCustomer()},handleClickOptional:function(){return a.ShowModalBarang()},empty:!0,textEmpty:"Data Barang Kosong",expandRow:e,margin:!0}),l.o.createElement("div",{className:"row"},l.o.createElement("div",{className:"col-6 text-left"},l.o.createElement("button",{className:"btn btn-primary",onClick:function(){return a.showModalPembayaran()}}," ","Simpan Pesanan"," "),"\xa0",l.o.createElement("button",{className:"btn btn-warning",onClick:function(){return a.reset()}},this.state.loadingreset?l.o.createElement(l.o.Fragment,null,l.o.createElement("i",{className:"fas fa-spinner fa-spin"})," \xa0 Reset"):"Reset")))),l.o.createElement("br",null)),l.o.createElement(l.j,{size:"ShowModalCustomer"===this.state.FormModal?"xl":"ShowModalBarang"===this.state.FormModal?"xl":"l",title:"ShowModalCustomer"===this.state.FormModal?"Data Customer":"ShowModalBarang"===this.state.FormModal?"Tambah Barang Pesanan":"Form Pembayaran",content:"ShowModalCustomer"===this.state.FormModal?l.o.createElement(b,{isLoadingDataCustomer:this.state.isLoadingDataCustomer,onSubmit:function(e){return a.handleSubmit(e)}}):"ShowModalBarang"===this.state.FormModal?l.o.createElement(M,{isLoadingTopBar:this.props.isLoadingTopBar,hideModal:function(){return a.hideModa()},onSubmit:function(e){return a.simpanBarang(e)}}):l.o.createElement(O,{isLoadingPembayranTitipan:this.state.isLoadingPembayranTitipan,isLoadingPembayran:this.state.isLoadingPembayran,bayarSekarang:function(e){return a.bayarSekarang(e)},simpanPembayaran:function(e){return a.simpanPembayaran(e)}})}),this.props.isLoadingPembayranTitipan?l.o.createElement(v.a,{loading:!0,background:"rgba(0, 0, 0, 0.35)",loaderColor:"rgba(94, 147, 117, 1)"}):null)}}]),t}(l.o.Component);x=Object(l.Y)({form:"Pesanan",enableReinitialize:!0})(x);e.default=Object(l.w)()(x)},693:function(a,e,t){"use strict";e.a=function(a){var e={};return a.jenis||(e.jenis="Jenis Tidak Boleh Kosong"),e}},719:function(a,e,t){"use strict";e.a=function(a){var e={};return a.kode_sales||(e.kode_sales="Kode Sales Harus Dipilih"),a.nama_customer||(e.nama_customer="Nama Customer Harus Diisi"),a.no_hp||(e.no_hp="No Hp Harus Diisi"),a.alamat||(e.alamat="Alamat Harus Diisi"),e}}}]);
//# sourceMappingURL=15.0cb77a71.chunk.js.map